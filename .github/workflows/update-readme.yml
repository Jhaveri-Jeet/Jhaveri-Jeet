name: Update README with Medium Blogs

on:
  schedule:
    - cron: '0 0 * * *' # Runs daily at midnight
  workflow_dispatch:

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Fetch recent Medium blog posts
        id: fetch_blogs
        run: |
          curl -s "https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/@jhaveri_jeet" | jq -r '.items[] | "- [\(.title)](\(.link))"' > blogs.txt

      - name: Update README
        run: |
          BLOGS=$(cat blogs.txt)
          sed -i "/<!-- BLOGS_START -->/,/<!-- BLOGS_END -->/d" README.md
          echo -e "<!-- BLOGS_START -->\n\n## Recent Medium Blogs\n\n$BLOGS\n\n<!-- BLOGS_END -->" >> README.md

      - name: Commit and push changes
        uses: EndBug/add-and-commit@v9
        with:
          add: 'README.md'
          message: 'Update README with recent Medium blogs'
